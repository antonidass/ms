% Вариант 11
function lab_3()
    clc
    T = [-5.00,-4.80,-4.60,-4.40,-4.20,-4.00,-3.80,-3.60,-3.40,-3.20, ...
         -3.00,-2.80,-2.60,-2.40,-2.20,-2.00,-1.80,-1.60,-1.40,-1.20, ...
         -1.00,-0.80,-0.60,-0.40,-0.20,0.00,0.20,0.40,0.60,0.80,1.00, ...
         1.20,1.40,1.60,1.80,2.00,2.20,2.40,2.60,2.80,3.00,3.20,3.40, ...
         3.60,3.80,4.00,4.20,4.40,4.60,4.80,5.00,5.20,5.40,5.60,5.80, ...
         6.00,6.20,6.40,6.60,6.80,7.00];
    Y = [-23.33,-51.17,-9.60,-25.13,35.42,-29.66,-16.56,-26.60,-9.52, ...
         -55.24,-26.38,-9.29,-30.18,-13.03,-2.67,-44.04,-22.10,14.26, ...
         1.90,15.23,-10.97,16.15,41.97,2.41,14.54,47.54,-1.73,19.05,  ...
         -16.56,19.20,-13.71,-7.97,-35.79,4.26,12.11,8.49,-22.74,     ...
         13.50,-40.73,-21.16,-19.63,10.61,-6.27,-31.38,-10.91,-9.06,  ...
         -27.11,-15.97,-12.55,-37.36,-22.32,-12.61,-21.23,-10.29,     ... 
         -28.08, -40.09,-33.55,1.42,-4.48,-30.29,-62.62];

    Yt = OLS(Y, T);
   
    delta = sqrt(sum((Y - Yt) .^ 2));
    fprintf('Delta = %.4f\n', delta);
    
    plot(T, Y, '.b', T, Yt, 'r');
    legend({
        'Система точек (t_i,y_i)';
        'Полученная модель';
    });
end

function Yt = OLS(Y, T)
    T2 = T .* T;
    psi = horzcat(ones(length(T), 1), T', T2');
    
    theta = (psi' * psi) \ (psi' * Y'); 
    fprintf("theta1 = %.4f\n", theta(1));
    fprintf("theta2 = %.4f\n", theta(2));
    fprintf("theta3 = %.4f\n", theta(3));
    fprintf("Yt = %.4f + %.4f*t + %.4f*t^2\n", theta(1), theta(2), theta(3));
   
    Yt = theta(1) + theta(2) * T + theta(3) * T2; 
end